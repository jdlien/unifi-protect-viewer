<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <style>
      :root {
        color-scheme: light dark;
      }

      body {
        font-family:
          system-ui,
          -apple-system,
          BlinkMacSystemFont,
          'Segoe UI',
          sans-serif;
        padding: 24px;
        text-align: center;
        margin: 0;
        overflow: hidden;
        user-select: none;
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
      }

      @media (prefers-color-scheme: dark) {
        body {
          background-color: #1e1e1e;
          color: #ffffff;
        }
        progress {
          accent-color: #0078d4;
        }
      }

      @media (prefers-color-scheme: light) {
        body {
          background-color: #f0f0f0;
          color: #333333;
        }
        progress {
          accent-color: #0078d4;
        }
      }

      .container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 16px;
        width: 100%;
      }

      h3 {
        margin: 0;
        font-weight: 500;
        font-size: 16px;
      }

      progress {
        width: 100%;
        height: 4px;
        border-radius: 2px;
      }

      .percent {
        font-weight: 600;
        font-size: 14px;
      }

      #status {
        font-size: 12px;
        color: #888;
        margin-top: 8px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h3>Downloading Update...</h3>
      <progress id="progressBar" value="0" max="100"></progress>
      <div class="percent" id="percent">0%</div>
      <div id="status"></div>
    </div>

    <script>
      // Listen for progress updates from the main process
      if (window.electronAPI) {
        window.electronAPI.onUpdateProgress((progress) => {
          if (progress && typeof progress === 'object') {
            const percent = Math.round(progress.percent || 0)
            document.getElementById('percent').textContent = percent + '%'
            document.getElementById('progressBar').value = percent

            if (progress.bytesPerSecond) {
              const speed = (progress.bytesPerSecond / 1024 / 1024).toFixed(2)
              const downloaded = (progress.transferred / 1024 / 1024).toFixed(2)
              const total = (progress.total / 1024 / 1024).toFixed(2)
              document.getElementById('status').textContent = `${downloaded} MB of ${total} MB (${speed} MB/s)`
            }
          }
        })
      }
    </script>
  </body>
</html>
